//quiz
const quiz = {
  questions: [
    {
      condition: "Заполните пропуски и ответьте на вопрос по тексту",
      text: "If you match these criteria, contact your manager because you qualify for a salary (1)_____ :",
      responses: [
        {
          text: "Upgrade",
          correct: true,
        },
        {
          text: "Grows",
        },
        {
          text: "Raise",
        },
      ],
    },
    {
      condition: "Condition 2",
      text: "Question 2",
      responses: [
        {
          text: "answer 1",
        },
        {
          text: "answer 2",
          correct: true,
        },
        {
          text: "answer 3",
        },
      ],
    },
    {
      condition: "Condition 3",
      text: "Question 3",
      responses: [
        {
          text: "answer 1",
        },
        {
          text: "answer 2",
        },
        {
          text: "Raise 3",
          correct: true,
        },
      ],
    },
    {
      condition: "Condition 4",
      text: "Question 4",
      responses: [
        {
          text: "answer 1",
          correct: true,
        },
        {
          text: "answer 2",
        },
        {
          text: "answer 3",
        },
      ],
    },
    {
      condition: "Condition 5",
      text: "Question 5",
      responses: [
        {
          text: "answer 15",
          correct: true,
        },
        {
          text: "answer 42",
        },
        {
          text: "answer 38",
        },
      ],
    },
  ],
};

const test = new Vue({
  el: "#app",
  data: {
    quiz: quiz,
    questionIndex: 0,
    userResponses: Array(quiz.questions.length).fill(false),
    text: `А это значит, что вам есть куда стремится.
        Осталось подтянуть совсем немного и вы освоите язык!`,
  },
  methods: {
    handleRadio(value) {
      this.userResponses[this.questionIndex] = value ? value : false;
    },
    next() {
      this.questionIndex++;
    },
    score() {
      return this.userResponses.filter((val) => val).length;
    },
  },
});

//disabled link
document.querySelector(".b-menu__link_disabled").onclick = (e) =>
  e.preventDefault();

//burger
const burger = document.querySelector(".b-burger");
const menu = document.querySelector(".b-menu");
burger.addEventListener("click", () => {
  burger.classList.toggle("active-burger");
  if (
    !menu.classList.contains("active-block") &&
    !menu.classList.contains("active-menu")
  ) {
    menu.classList.add("active-block");
    setTimeout(() => {
      menu.classList.add("active-menu");
    }, 100);
    document.body.classList.add("b-fixed");
  }
  if (
    menu.classList.contains("active-block") &&
    menu.classList.contains("active-menu")
  ) {
    menu.classList.remove("active-menu");
    setTimeout(() => {
      menu.classList.remove("active-block");
    }, 400);
    document.body.classList.remove("b-fixed");
  }
});

//ACCORDEON
const accordeonBtn = document.querySelectorAll("[data-accordeon-btn]");
const accordeonContent = document.querySelectorAll("[data-accordeon-content]");

accordeonBtn.forEach((el) => {
  el.addEventListener("click", (event) => {
    if (!el.classList.contains("active")) {
      cleanActivBtns();
      el.classList.add("active");
      const target = event.currentTarget.getAttribute("data-accordeon-btn");
      hideAccordeons();
      let currentAccordeon = document.querySelector(
        `[data-accordeon-content="${target}"]`
      );
      var accordeonChild = currentAccordeon.firstElementChild.scrollHeight;
      currentAccordeon.style.height = `calc(${accordeonChild}px + 10.6vw)`;
      currentAccordeon.classList.add("active");
    } else if (el.classList.contains("active")) {
      cleanActivBtns();
      hideAccordeons();
    }

    function hideAccordeons() {
      accordeonContent.forEach((el) => {
        el.style.height = "0";
        el.classList.remove("active");
      });
    }

    function cleanActivBtns() {
      accordeonBtn.forEach((el) => {
        el.classList.remove("active");
      });
    }
  });
});

//LOAD VIDEO from link after click 'play'
const videos = document.querySelectorAll(".b-video");
let generateUrl = function (id) {
  let query = "?rel=0&showinfo=0&autoplay=1";
  return "https://www.youtube.com/embed/" + id + query;
};
let createIframe = function (id) {
  let iframe = document.createElement("iframe");
  iframe.setAttribute("allowfullscreen", "");
  iframe.setAttribute("allow", "autoplay; encrypted-media");
  iframe.setAttribute("src", generateUrl(id));
  return iframe;
};
videos.forEach((el) => {
  let videoHref = el.getAttribute("data-video");
  let deletedLength = "https://youtu.be/".length;
  let videoId = videoHref.substring(deletedLength, videoHref.length);
  let img = el.querySelector("img");
  let youtubeImgSrc =
    "https://i.ytimg.com/vi/" + videoId + "/maxresdefault.jpg";
  img.setAttribute("src", youtubeImgSrc);
  el.addEventListener("click", (e) => {
    e.preventDefault();
    let iframe = createIframe(videoId);
    el.querySelector("img").remove();
    el.appendChild(iframe);
    el.querySelector("button").remove();
  });
});

//---MODALS---
//hide all modals
const modalOpen = document.querySelectorAll("[data-modal-open]");
const modals = document.querySelectorAll("[data-modal]");
const moadalInner = document.querySelectorAll(".b-modal");
const closeModal = document.querySelectorAll("[data-modal-close]");
function hideModals() {
  modals.forEach((elem) => {
    elem.classList.remove("b-show");
  });
}

//find & open current modal, close rest & block scroll
modalOpen.forEach((elem) => {
  elem.addEventListener("click", (event) => {
    event.preventDefault();
    let target = event.currentTarget.getAttribute("data-modal-open");
    hideModals();
    document.body.classList.add("b-blockScroll");
    let targetModal = document.querySelector(`[data-modal="${target}"]`);
    targetModal.classList.add("b-show");
    let currentVideo = document.querySelector("video");
    if (targetModal.contains(currentVideo)) {
      currentVideo.play();
      currentVideo.setAttribute("data-play", "");
    }
  });
});

//close btn active
closeModal.forEach(
  (el) =>
    (el.onclick = () => {
      hideModals();
      document.body.classList.remove("b-blockScroll");
    })
);

//close to click overlay
window.addEventListener("click", function (e) {
  modals.forEach((el) => {
    if (el == e.target && e.target != moadalInner) {
      document.body.classList.remove("b-blockScroll");
      hideModals();
      closeVideo();
    }
  });
});

function closeVideo() {
  currentPlayVideo.forEach((el) => {
    el.pause();
    el.currentTime = 0;
  });
}

//sliders
const swiper = new Swiper(".mySwiper", {
  spaceBetween: 100,
  effect: "fade",
  fadeEffect: {
    crossFade: true,
  },
  pagination: {
    el: ".swiper-pagination",
    type: "custom",
    renderCustom: function (swiper, current, total) {
      if (current < 10) {
        current = "0" + current;
      }
      if (total < 10) {
        total = "0" + total;
      }
      return current + " ... " + total;
    },
  },
  navigation: {
    nextEl: ".swiper-button-next",
    prevEl: ".swiper-button-prev",
  },
});

// const swiper = new Swiper(".mySwiper", {
//     spaceBetween: 100,
//     effect: "fade",
//     fadeEffect: {
//         crossFade: true,
//     },
//     pagination: {
//         el: ".swiper-pagination",
//         type: 'custom',
//         renderCustom: function (swiper, current, total) {
//             if (current < 10) {
//                 total = '0' + total
//             }
//             if (total < 10) {
//                 current = '0' + current
//             }
//             return current + ' ... ' + (total);
//         }
//     },
//     navigation: {
//         nextEl: ".swiper-button-next",
//         prevEl: ".swiper-button-prev",
//     },
// });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL3F1aXpcbmNvbnN0IHF1aXogPSB7XG4gIHF1ZXN0aW9uczogW1xuICAgIHtcbiAgICAgIGNvbmRpdGlvbjogXCLQl9Cw0L/QvtC70L3QuNGC0LUg0L/RgNC+0L/Rg9GB0LrQuCDQuCDQvtGC0LLQtdGC0YzRgtC1INC90LAg0LLQvtC/0YDQvtGBINC/0L4g0YLQtdC60YHRgtGDXCIsXG4gICAgICB0ZXh0OiBcIklmIHlvdSBtYXRjaCB0aGVzZSBjcml0ZXJpYSwgY29udGFjdCB5b3VyIG1hbmFnZXIgYmVjYXVzZSB5b3UgcXVhbGlmeSBmb3IgYSBzYWxhcnkgKDEpX19fX18gOlwiLFxuICAgICAgcmVzcG9uc2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICB0ZXh0OiBcIlVwZ3JhZGVcIixcbiAgICAgICAgICBjb3JyZWN0OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgdGV4dDogXCJHcm93c1wiLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgdGV4dDogXCJSYWlzZVwiLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGNvbmRpdGlvbjogXCJDb25kaXRpb24gMlwiLFxuICAgICAgdGV4dDogXCJRdWVzdGlvbiAyXCIsXG4gICAgICByZXNwb25zZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHRleHQ6IFwiYW5zd2VyIDFcIixcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHRleHQ6IFwiYW5zd2VyIDJcIixcbiAgICAgICAgICBjb3JyZWN0OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgdGV4dDogXCJhbnN3ZXIgM1wiLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGNvbmRpdGlvbjogXCJDb25kaXRpb24gM1wiLFxuICAgICAgdGV4dDogXCJRdWVzdGlvbiAzXCIsXG4gICAgICByZXNwb25zZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHRleHQ6IFwiYW5zd2VyIDFcIixcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHRleHQ6IFwiYW5zd2VyIDJcIixcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHRleHQ6IFwiUmFpc2UgM1wiLFxuICAgICAgICAgIGNvcnJlY3Q6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgY29uZGl0aW9uOiBcIkNvbmRpdGlvbiA0XCIsXG4gICAgICB0ZXh0OiBcIlF1ZXN0aW9uIDRcIixcbiAgICAgIHJlc3BvbnNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgdGV4dDogXCJhbnN3ZXIgMVwiLFxuICAgICAgICAgIGNvcnJlY3Q6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICB0ZXh0OiBcImFuc3dlciAyXCIsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICB0ZXh0OiBcImFuc3dlciAzXCIsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgY29uZGl0aW9uOiBcIkNvbmRpdGlvbiA1XCIsXG4gICAgICB0ZXh0OiBcIlF1ZXN0aW9uIDVcIixcbiAgICAgIHJlc3BvbnNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgdGV4dDogXCJhbnN3ZXIgMTVcIixcbiAgICAgICAgICBjb3JyZWN0OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgdGV4dDogXCJhbnN3ZXIgNDJcIixcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHRleHQ6IFwiYW5zd2VyIDM4XCIsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG4gIF0sXG59O1xuXG5jb25zdCB0ZXN0ID0gbmV3IFZ1ZSh7XG4gIGVsOiBcIiNhcHBcIixcbiAgZGF0YToge1xuICAgIHF1aXo6IHF1aXosXG4gICAgcXVlc3Rpb25JbmRleDogMCxcbiAgICB1c2VyUmVzcG9uc2VzOiBBcnJheShxdWl6LnF1ZXN0aW9ucy5sZW5ndGgpLmZpbGwoZmFsc2UpLFxuICAgIHRleHQ6IGDQkCDRjdGC0L4g0LfQvdCw0YfQuNGCLCDRh9GC0L4g0LLQsNC8INC10YHRgtGMINC60YPQtNCwINGB0YLRgNC10LzQuNGC0YHRjy5cbiAgICAgICAg0J7RgdGC0LDQu9C+0YHRjCDQv9C+0LTRgtGP0L3Rg9GC0Ywg0YHQvtCy0YHQtdC8INC90LXQvNC90L7Qs9C+INC4INCy0Ysg0L7RgdCy0L7QuNGC0LUg0Y/Qt9GL0LohYCxcbiAgfSxcbiAgbWV0aG9kczoge1xuICAgIGhhbmRsZVJhZGlvKHZhbHVlKSB7XG4gICAgICB0aGlzLnVzZXJSZXNwb25zZXNbdGhpcy5xdWVzdGlvbkluZGV4XSA9IHZhbHVlID8gdmFsdWUgOiBmYWxzZTtcbiAgICB9LFxuICAgIG5leHQoKSB7XG4gICAgICB0aGlzLnF1ZXN0aW9uSW5kZXgrKztcbiAgICB9LFxuICAgIHNjb3JlKCkge1xuICAgICAgcmV0dXJuIHRoaXMudXNlclJlc3BvbnNlcy5maWx0ZXIoKHZhbCkgPT4gdmFsKS5sZW5ndGg7XG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vL2Rpc2FibGVkIGxpbmtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYi1tZW51X19saW5rX2Rpc2FibGVkXCIpLm9uY2xpY2sgPSAoZSkgPT5cbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4vL2J1cmdlclxuY29uc3QgYnVyZ2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5iLWJ1cmdlclwiKTtcbmNvbnN0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmItbWVudVwiKTtcbmJ1cmdlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBidXJnZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZS1idXJnZXJcIik7XG4gIGlmIChcbiAgICAhbWVudS5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmUtYmxvY2tcIikgJiZcbiAgICAhbWVudS5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmUtbWVudVwiKVxuICApIHtcbiAgICBtZW51LmNsYXNzTGlzdC5hZGQoXCJhY3RpdmUtYmxvY2tcIik7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBtZW51LmNsYXNzTGlzdC5hZGQoXCJhY3RpdmUtbWVudVwiKTtcbiAgICB9LCAxMDApO1xuICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImItZml4ZWRcIik7XG4gIH1cbiAgaWYgKFxuICAgIG1lbnUuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlLWJsb2NrXCIpICYmXG4gICAgbWVudS5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmUtbWVudVwiKVxuICApIHtcbiAgICBtZW51LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmUtbWVudVwiKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZS1ibG9ja1wiKTtcbiAgICB9LCA0MDApO1xuICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShcImItZml4ZWRcIik7XG4gIH1cbn0pO1xuXG4vL0FDQ09SREVPTlxuY29uc3QgYWNjb3JkZW9uQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLWFjY29yZGVvbi1idG5dXCIpO1xuY29uc3QgYWNjb3JkZW9uQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1hY2NvcmRlb24tY29udGVudF1cIik7XG5cbmFjY29yZGVvbkJ0bi5mb3JFYWNoKChlbCkgPT4ge1xuICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgaWYgKCFlbC5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIikpIHtcbiAgICAgIGNsZWFuQWN0aXZCdG5zKCk7XG4gICAgICBlbC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQuY3VycmVudFRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWFjY29yZGVvbi1idG5cIik7XG4gICAgICBoaWRlQWNjb3JkZW9ucygpO1xuICAgICAgbGV0IGN1cnJlbnRBY2NvcmRlb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBgW2RhdGEtYWNjb3JkZW9uLWNvbnRlbnQ9XCIke3RhcmdldH1cIl1gXG4gICAgICApO1xuICAgICAgdmFyIGFjY29yZGVvbkNoaWxkID0gY3VycmVudEFjY29yZGVvbi5maXJzdEVsZW1lbnRDaGlsZC5zY3JvbGxIZWlnaHQ7XG4gICAgICBjdXJyZW50QWNjb3JkZW9uLnN0eWxlLmhlaWdodCA9IGBjYWxjKCR7YWNjb3JkZW9uQ2hpbGR9cHggKyAxMC42dncpYDtcbiAgICAgIGN1cnJlbnRBY2NvcmRlb24uY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICB9IGVsc2UgaWYgKGVsLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSkge1xuICAgICAgY2xlYW5BY3RpdkJ0bnMoKTtcbiAgICAgIGhpZGVBY2NvcmRlb25zKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGlkZUFjY29yZGVvbnMoKSB7XG4gICAgICBhY2NvcmRlb25Db250ZW50LmZvckVhY2goKGVsKSA9PiB7XG4gICAgICAgIGVsLnN0eWxlLmhlaWdodCA9IFwiMFwiO1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYW5BY3RpdkJ0bnMoKSB7XG4gICAgICBhY2NvcmRlb25CdG4uZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59KTtcblxuLy9MT0FEIFZJREVPIGZyb20gbGluayBhZnRlciBjbGljayAncGxheSdcbmNvbnN0IHZpZGVvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYi12aWRlb1wiKTtcbmxldCBnZW5lcmF0ZVVybCA9IGZ1bmN0aW9uIChpZCkge1xuICBsZXQgcXVlcnkgPSBcIj9yZWw9MCZzaG93aW5mbz0wJmF1dG9wbGF5PTFcIjtcbiAgcmV0dXJuIFwiaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvXCIgKyBpZCArIHF1ZXJ5O1xufTtcbmxldCBjcmVhdGVJZnJhbWUgPSBmdW5jdGlvbiAoaWQpIHtcbiAgbGV0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7XG4gIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJhbGxvd2Z1bGxzY3JlZW5cIiwgXCJcIik7XG4gIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJhbGxvd1wiLCBcImF1dG9wbGF5OyBlbmNyeXB0ZWQtbWVkaWFcIik7XG4gIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgZ2VuZXJhdGVVcmwoaWQpKTtcbiAgcmV0dXJuIGlmcmFtZTtcbn07XG52aWRlb3MuZm9yRWFjaCgoZWwpID0+IHtcbiAgbGV0IHZpZGVvSHJlZiA9IGVsLmdldEF0dHJpYnV0ZShcImRhdGEtdmlkZW9cIik7XG4gIGxldCBkZWxldGVkTGVuZ3RoID0gXCJodHRwczovL3lvdXR1LmJlL1wiLmxlbmd0aDtcbiAgbGV0IHZpZGVvSWQgPSB2aWRlb0hyZWYuc3Vic3RyaW5nKGRlbGV0ZWRMZW5ndGgsIHZpZGVvSHJlZi5sZW5ndGgpO1xuICBsZXQgaW1nID0gZWwucXVlcnlTZWxlY3RvcihcImltZ1wiKTtcbiAgbGV0IHlvdXR1YmVJbWdTcmMgPVxuICAgIFwiaHR0cHM6Ly9pLnl0aW1nLmNvbS92aS9cIiArIHZpZGVvSWQgKyBcIi9tYXhyZXNkZWZhdWx0LmpwZ1wiO1xuICBpbWcuc2V0QXR0cmlidXRlKFwic3JjXCIsIHlvdXR1YmVJbWdTcmMpO1xuICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgbGV0IGlmcmFtZSA9IGNyZWF0ZUlmcmFtZSh2aWRlb0lkKTtcbiAgICBlbC5xdWVyeVNlbGVjdG9yKFwiaW1nXCIpLnJlbW92ZSgpO1xuICAgIGVsLmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gICAgZWwucXVlcnlTZWxlY3RvcihcImJ1dHRvblwiKS5yZW1vdmUoKTtcbiAgfSk7XG59KTtcblxuLy8tLS1NT0RBTFMtLS1cbi8vaGlkZSBhbGwgbW9kYWxzXG5jb25zdCBtb2RhbE9wZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW2RhdGEtbW9kYWwtb3Blbl1cIik7XG5jb25zdCBtb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW2RhdGEtbW9kYWxdXCIpO1xuY29uc3QgbW9hZGFsSW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmItbW9kYWxcIik7XG5jb25zdCBjbG9zZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLW1vZGFsLWNsb3NlXVwiKTtcbmZ1bmN0aW9uIGhpZGVNb2RhbHMoKSB7XG4gIG1vZGFscy5mb3JFYWNoKChlbGVtKSA9PiB7XG4gICAgZWxlbS5jbGFzc0xpc3QucmVtb3ZlKFwiYi1zaG93XCIpO1xuICB9KTtcbn1cblxuLy9maW5kICYgb3BlbiBjdXJyZW50IG1vZGFsLCBjbG9zZSByZXN0ICYgYmxvY2sgc2Nyb2xsXG5tb2RhbE9wZW4uZm9yRWFjaCgoZWxlbSkgPT4ge1xuICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGxldCB0YXJnZXQgPSBldmVudC5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZShcImRhdGEtbW9kYWwtb3BlblwiKTtcbiAgICBoaWRlTW9kYWxzKCk7XG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKFwiYi1ibG9ja1Njcm9sbFwiKTtcbiAgICBsZXQgdGFyZ2V0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1tb2RhbD1cIiR7dGFyZ2V0fVwiXWApO1xuICAgIHRhcmdldE1vZGFsLmNsYXNzTGlzdC5hZGQoXCJiLXNob3dcIik7XG4gICAgbGV0IGN1cnJlbnRWaWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ2aWRlb1wiKTtcbiAgICBpZiAodGFyZ2V0TW9kYWwuY29udGFpbnMoY3VycmVudFZpZGVvKSkge1xuICAgICAgY3VycmVudFZpZGVvLnBsYXkoKTtcbiAgICAgIGN1cnJlbnRWaWRlby5zZXRBdHRyaWJ1dGUoXCJkYXRhLXBsYXlcIiwgXCJcIik7XG4gICAgfVxuICB9KTtcbn0pO1xuXG4vL2Nsb3NlIGJ0biBhY3RpdmVcbmNsb3NlTW9kYWwuZm9yRWFjaChcbiAgKGVsKSA9PlxuICAgIChlbC5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgaGlkZU1vZGFscygpO1xuICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwiYi1ibG9ja1Njcm9sbFwiKTtcbiAgICB9KVxuKTtcblxuLy9jbG9zZSB0byBjbGljayBvdmVybGF5XG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG4gIG1vZGFscy5mb3JFYWNoKChlbCkgPT4ge1xuICAgIGlmIChlbCA9PSBlLnRhcmdldCAmJiBlLnRhcmdldCAhPSBtb2FkYWxJbm5lcikge1xuICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwiYi1ibG9ja1Njcm9sbFwiKTtcbiAgICAgIGhpZGVNb2RhbHMoKTtcbiAgICAgIGNsb3NlVmlkZW8oKTtcbiAgICB9XG4gIH0pO1xufSk7XG5cbmZ1bmN0aW9uIGNsb3NlVmlkZW8oKSB7XG4gIGN1cnJlbnRQbGF5VmlkZW8uZm9yRWFjaCgoZWwpID0+IHtcbiAgICBlbC5wYXVzZSgpO1xuICAgIGVsLmN1cnJlbnRUaW1lID0gMDtcbiAgfSk7XG59XG5cbi8vc2xpZGVyc1xuY29uc3Qgc3dpcGVyID0gbmV3IFN3aXBlcihcIi5teVN3aXBlclwiLCB7XG4gIHNwYWNlQmV0d2VlbjogMTAwLFxuICBlZmZlY3Q6IFwiZmFkZVwiLFxuICBmYWRlRWZmZWN0OiB7XG4gICAgY3Jvc3NGYWRlOiB0cnVlLFxuICB9LFxuICBwYWdpbmF0aW9uOiB7XG4gICAgZWw6IFwiLnN3aXBlci1wYWdpbmF0aW9uXCIsXG4gICAgdHlwZTogXCJjdXN0b21cIixcbiAgICByZW5kZXJDdXN0b206IGZ1bmN0aW9uIChzd2lwZXIsIGN1cnJlbnQsIHRvdGFsKSB7XG4gICAgICBpZiAoY3VycmVudCA8IDEwKSB7XG4gICAgICAgIGN1cnJlbnQgPSBcIjBcIiArIGN1cnJlbnQ7XG4gICAgICB9XG4gICAgICBpZiAodG90YWwgPCAxMCkge1xuICAgICAgICB0b3RhbCA9IFwiMFwiICsgdG90YWw7XG4gICAgICB9XG4gICAgICByZXR1cm4gY3VycmVudCArIFwiIC4uLiBcIiArIHRvdGFsO1xuICAgIH0sXG4gIH0sXG4gIG5hdmlnYXRpb246IHtcbiAgICBuZXh0RWw6IFwiLnN3aXBlci1idXR0b24tbmV4dFwiLFxuICAgIHByZXZFbDogXCIuc3dpcGVyLWJ1dHRvbi1wcmV2XCIsXG4gIH0sXG59KTtcblxuLy8gY29uc3Qgc3dpcGVyID0gbmV3IFN3aXBlcihcIi5teVN3aXBlclwiLCB7XG4vLyAgICAgc3BhY2VCZXR3ZWVuOiAxMDAsXG4vLyAgICAgZWZmZWN0OiBcImZhZGVcIixcbi8vICAgICBmYWRlRWZmZWN0OiB7XG4vLyAgICAgICAgIGNyb3NzRmFkZTogdHJ1ZSxcbi8vICAgICB9LFxuLy8gICAgIHBhZ2luYXRpb246IHtcbi8vICAgICAgICAgZWw6IFwiLnN3aXBlci1wYWdpbmF0aW9uXCIsXG4vLyAgICAgICAgIHR5cGU6ICdjdXN0b20nLFxuLy8gICAgICAgICByZW5kZXJDdXN0b206IGZ1bmN0aW9uIChzd2lwZXIsIGN1cnJlbnQsIHRvdGFsKSB7XG4vLyAgICAgICAgICAgICBpZiAoY3VycmVudCA8IDEwKSB7XG4vLyAgICAgICAgICAgICAgICAgdG90YWwgPSAnMCcgKyB0b3RhbFxuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgaWYgKHRvdGFsIDwgMTApIHtcbi8vICAgICAgICAgICAgICAgICBjdXJyZW50ID0gJzAnICsgY3VycmVudFxuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnQgKyAnIC4uLiAnICsgKHRvdGFsKTtcbi8vICAgICAgICAgfVxuLy8gICAgIH0sXG4vLyAgICAgbmF2aWdhdGlvbjoge1xuLy8gICAgICAgICBuZXh0RWw6IFwiLnN3aXBlci1idXR0b24tbmV4dFwiLFxuLy8gICAgICAgICBwcmV2RWw6IFwiLnN3aXBlci1idXR0b24tcHJldlwiLFxuLy8gICAgIH0sXG4vLyB9KTtcbiJdfQ==
